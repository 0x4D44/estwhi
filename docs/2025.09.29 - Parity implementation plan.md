# Estimation Whist – Parity Implementation Plan (Sep 29, 2025)

## Phase 0 – Preparation (Day 0–1)
1. Create tracking issues for each parity initiative so progress is visible.
2. Capture baseline screenshots/logs of the current build (hand, trick, dialogs) for comparison.
3. Confirm local tooling: ensure `tools/extract-res` builds and note required SDK versions for `rc.exe`.

## Phase 1 – Complete 71×96 Card Asset Set (Day 1–3)
1. Extend `tools/extract-res` to emit the remaining `card_71x96_0XX.bmp` assets from `ESTWHI.RES`. If IDs are missing, batch-process the modern `cards2` deck to enforce opaque white backgrounds (24-bit DIB conversion).
2. Update `resources/cards.rcinc` so all 52 IDs reference the finalized set; remove mixed `cards_from_exe` / `cards2` references.
3. Regenerate assets and commit them (or check in the preprocessing script if transformation happens at build time).
4. Add a smoke test command (e.g., `cargo run -p tools/extract-res -- --input ESTWHI.RES --out assets/cards`) and document it in the README.
5. Rebuild with resources (`cargo clean -p estwhi && cargo build --release`) and verify card rendering in both layouts.
6. Attach before/after screenshots to the tracking issue.

## Phase 2 – Cheat & Probability Windows (Day 3–6)
1. Port the helper windows: implement `CheatWindow` and `ProbWindow` structs, register Win32 classes, and replicate GDI drawing routines (probability grid, cheat information).
2. Wire Options dialog toggles so enabling/disabling creates/destroys the HWNDs; persist geometry and visibility in the registry.
3. Hook game events (deal, call, trick) to refresh window content.
4. Manual QA: open/close dialogs, drag/resize windows, restart app to confirm persistence, and verify cheat info stays in sync.

## Phase 3 – Random Things & Icon Twirl (Day 6–8)
1. Recreate timer handlers (`ID_RNDTIMER`, `ID_ICNTIMER`) translating Pascal’s logic into Win32 timers.
2. Implement the Random Things dialog controls and persist their state; ensure toggles start/stop timers as the original did.
3. Verify timers pause/resume appropriately during gameplay and that icon twirl obeys configured intervals.
4. Document any deviations if the feature is simplified or retired.

## Phase 4 – Asset Pipeline Safety Check & CI (Day 8–9)
1. Enhance `build.rs` (or add a helper tool) to validate that every bitmap path in `resources/cards.rcinc` exists.
2. Optionally add image linting (bit depth, alpha, background) to fail fast on malformed assets.
3. Integrate the validation into CI (GitHub Actions) and document the local command in `README.md`.
4. Provide troubleshooting guidance for common `rc.exe`/asset errors.

## Phase 5 – Final QA & Documentation (Day 9–10)
1. Run full gameplay regression tests: bidding, trick pauses (Dialog & Mouse), scoring, options persistence, helper windows, timers.
2. Capture side-by-side screenshots vs. the Turbo Pascal build.
3. Update design notes and release summary; close tracking issues and mark the parity milestone complete.

## Dependencies & Notes
- Phase 1 must complete before Phase 4 validation.
- Phases 2 and 3 can proceed in parallel once assets are finalized.
- Allocate at least one day buffer for Win32 quirks or asset extraction hurdles.
